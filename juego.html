<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Infiltrado - Multijugador</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a; /* Slate 900 */
            color: white;
            touch-action: manipulation;
            user-select: none; /* Evitar selecci칩n de texto accidental */
        }

        .card-anim {
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .btn-primary {
            background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            transition: transform 0.1s, filter 0.2s;
        }
        .btn-primary:active {
            transform: scale(0.95);
            filter: brightness(0.9);
        }

        .btn-secondary {
            background: #1e293b;
            border: 1px solid #334155;
            transition: all 0.2s;
        }
        .btn-secondary:active {
            background: #0f172a;
        }

        .role-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="h-screen w-full flex flex-col items-center justify-center p-4 overflow-hidden relative">

    <div class="absolute top-0 left-0 w-full h-full overflow-hidden -z-10">
        <div class="absolute top-10 left-10 w-32 h-32 bg-purple-600 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob"></div>
        <div class="absolute bottom-10 right-10 w-32 h-32 bg-indigo-600 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000"></div>
    </div>

    <div id="screen-home" class="flex flex-col items-center text-center space-y-6 max-w-md w-full">
        <div class="space-y-2">
            <div class="inline-block p-4 rounded-2xl bg-slate-800 mb-2 shadow-xl border border-slate-700">
                <i data-lucide="venetian-mask" class="w-16 h-16 text-indigo-400 mx-auto"></i>
            </div>
            <h1 class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400">
                EL INFILTRADO
            </h1>
            <p class="text-slate-400 text-lg">Juego de deducci칩n</p>
        </div>

        <div class="bg-slate-800/80 p-6 rounded-xl border border-slate-700 w-full space-y-4">
            <label class="text-indigo-300 font-bold text-sm uppercase tracking-wider">N칰mero de Jugadores</label>
            
            <div class="flex items-center justify-between bg-slate-900 rounded-lg p-2">
                <button onclick="changePlayerCount(-1)" class="w-12 h-12 rounded-lg bg-slate-700 hover:bg-slate-600 text-white flex items-center justify-center text-2xl font-bold active:scale-90 transition-transform">
                    -
                </button>
                
                <div class="text-center">
                    <span id="player-count-display" class="text-4xl font-black text-white">3</span>
                </div>

                <button onclick="changePlayerCount(1)" class="w-12 h-12 rounded-lg bg-slate-700 hover:bg-slate-600 text-white flex items-center justify-center text-2xl font-bold active:scale-90 transition-transform">
                    +
                </button>
            </div>
            <p class="text-xs text-slate-500">M칤nimo 3, M치ximo 20</p>
        </div>

        <div class="bg-slate-800/50 p-4 rounded-xl border border-slate-700 w-full text-left">
            <h3 class="font-bold text-indigo-300 flex items-center gap-2 text-sm mb-2">
                <i data-lucide="info" class="w-4 h-4"></i> C칩mo jugar:
            </h3>
            <ul class="text-xs text-slate-300 space-y-1 list-disc list-inside">
                <li>Todos reciben una palabra secreta menos uno.</li>
                <li>Pasa el m칩vil para ver vuestro rol.</li>
                <li>El <strong>Impostor</strong> debe mentir.</li>
            </ul>
        </div>

        <button onclick="startGame()" class="btn-primary w-full py-4 rounded-xl text-xl font-bold shadow-lg shadow-indigo-500/30 flex items-center justify-center gap-2">
            <i data-lucide="play"></i> Empezar Partida
        </button>
    </div>

    <div id="screen-pass" class="hidden flex-col items-center text-center space-y-8 max-w-md w-full card-anim">
        <div class="text-6xl mb-4 animate-bounce">游뱖</div>
        <h2 class="text-2xl font-bold text-white">Dale el m칩vil al</h2>
        <div class="text-5xl font-black text-indigo-400 my-4" id="player-name-display">Jugador 1</div>
        <p class="text-slate-400 px-6">Aseg칰rate de que nadie m치s est칠 mirando la pantalla.</p>
        
        <button onclick="revealRole()" class="bg-slate-700 hover:bg-slate-600 w-full py-4 rounded-xl text-xl font-bold border border-slate-600 transition-colors flex items-center justify-center gap-2">
            <i data-lucide="eye"></i> Ver mi Rol
        </button>
    </div>

    <div id="screen-reveal" class="hidden flex-col items-center text-center justify-between py-8 h-3/4 max-w-md w-full card-anim role-card rounded-2xl p-6">
        
        <div class="w-full flex justify-center">
             <span class="bg-slate-800 px-4 py-1 rounded-full text-xs font-mono text-slate-400 border border-slate-700" id="current-player-tag">JUGADOR 1</span>
        </div>

        <div class="flex flex-col items-center justify-center flex-grow space-y-6 w-full">
            <div id="role-icon-container">
                </div>
            
            <div class="space-y-2 w-full">
                <h3 class="text-xl text-slate-300">Tu palabra secreta es:</h3>
                <div id="secret-word-display" class="text-4xl md:text-5xl font-black text-white break-words p-6 bg-slate-900/80 rounded-xl border border-white/10 shadow-inner">
                    </div>
            </div>
            
            <p id="role-instruction" class="text-sm text-slate-400 max-w-xs mx-auto">
                </p>
        </div>

        <button onclick="hideRole()" class="btn-primary w-full py-4 rounded-xl text-xl font-bold shadow-lg flex items-center justify-center gap-2">
            <i data-lucide="eye-off"></i> Ocultar y Pasar
        </button>
    </div>

    <div id="screen-game" class="hidden flex-col items-center text-center space-y-6 max-w-md w-full card-anim">
        <div class="w-24 h-24 bg-red-500 rounded-full flex items-center justify-center shadow-red-500/50 shadow-2xl mb-2 animate-pulse">
            <i data-lucide="siren" class="w-12 h-12 text-white"></i>
        </div>
        
        <div class="space-y-2">
            <h2 class="text-3xl font-black text-white">춰Todos listos!</h2>
            <p class="text-base text-slate-300 px-4">
                Empezad a decir una palabra relacionada con la secreta. El impostor est치 entre vosotros.
            </p>
        </div>
        
        <div class="bg-slate-800/80 p-6 rounded-xl border border-slate-700 w-full">
            <p class="text-slate-400 text-xs mb-3 uppercase tracking-widest font-bold border-b border-slate-700 pb-2">Estado de la Partida</p>
            <div class="flex justify-between items-center text-sm mb-2">
                <span class="text-slate-300">Total Jugadores:</span>
                <span class="font-bold text-white text-lg" id="stat-total-players">3</span>
            </div>
            <div class="flex justify-between items-center text-sm">
                <span class="text-slate-300">Impostores:</span>
                <span class="font-bold text-red-400 text-lg">1</span>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4 w-full">
            <button onclick="revealImpostor()" id="btn-reveal" class="bg-slate-700 hover:bg-slate-600 py-4 rounded-xl font-bold border border-slate-600 text-sm transition-colors">
                Revelar Verdad
            </button>
            <button onclick="resetGame()" class="bg-indigo-600 hover:bg-indigo-500 py-4 rounded-xl font-bold text-white shadow-lg text-sm transition-colors">
                Nueva Partida
            </button>
        </div>
        
        <div id="final-reveal" class="hidden w-full bg-slate-900 border border-slate-700 p-6 rounded-xl mt-4 card-anim text-left">
            <div class="mb-4 pb-4 border-b border-slate-800">
                <p class="text-slate-500 text-xs uppercase font-bold mb-1">La palabra era</p>
                <p id="final-word" class="text-2xl font-black text-indigo-400"></p>
            </div>
            <div>
                <p class="text-slate-500 text-xs uppercase font-bold mb-1">El impostor era</p>
                <div class="flex items-center gap-2">
                    <i data-lucide="skull" class="w-5 h-5 text-red-500"></i>
                    <p id="final-impostor" class="text-2xl font-black text-red-400"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- BASE DE DATOS DE PALABRAS ---
        const WORDS = [
	    // --- CL츼SICOS Y OBJETOS ---
	    "Pizza", "Playa", "Avi칩n", "Internet", "F칰tbol", "Guitarra", 
	    "Hospital", "Chocolate", "Elefante", "Fantasma", "Vampiro", 
	    "Escuela", "Navidad", "Cerveza", "Superh칠roe", "Zombie",
	    "YouTube", "TikTok", "Cine", "Piscina", "Monta침a", "Tigre",
	    "Dinosaurio", "Alien칤gena", "Robot", "Pirata", "Ninja", "Mago",
	    "Instagram", "Netflix", "Hamburguesa", "Sushi", "Gato", "Perro",
	    "Boda", "Divorcio", "C치rcel", "Hotel", "Casino", "Biblioteca",
	    "Gimnasio", "Parque", "Circo", "Zool칩gico", "Museo", "Iglesia",

	    // --- PERSONAJES Y FAMOSOS (ESPA칌A/MUNDO) ---
	    "Pedro S치nchez", "El Rey Em칠rito", "Messi", "Cristiano Ronaldo",
	    "Rosal칤a", "Ibai Llanos", "Fernando Alonso", "Bel칠n Esteban",
	    "El Papa", "Donald Trump", "Putin", "Doraemon", "Shrek",
	    "Harry Potter", "Darth Vader", "Spiderman", "Barbie", "Oppenheimer",
	    "Torrente", "Paquita Salas", "La Reina Letizia", "Amancio Ortega",
	    
	    // --- LUGARES Y SITUACIONES COTIDIANAS ---
	    "Mercadona", "IKEA", "Desguace", "Tanatorio", "Sex Shop",
	    "Comisar칤a", "Manicomio", "Matadero", "Sauna", "Discoteca",
	    "After", "Chiquipark", "Residencia de ancianos", "Dentista",
	    "Proct칩logo", "Clase de Matem치ticas", "Examen de Conducir",
	    "Cola del Paro", "Metro en hora punta", "Ascensor", "Ba침o p칰blico",

	    // --- COMIDA Y BEBIDA (ALGO M츼S ESPEC칈FICA) ---
	    "Paella", "Tortilla de Patatas", "Kebab", "Torrezno", "Br칩coli",
	    "Coliflor", "Vino Don Sim칩n", "J칛germeister", "Agua del grifo",
	    "Fabada", "Gazpacho", "Salmorejo", "Churros", "Ensaimada",
	    "Callos", "Bocadillo de calamares", "Tofu", "Leche de soja",

	    // --- HUMOR, TAB칔 Y COSAS ABSURDAS ---
	    "Resaca", "Gastroenteritis", "Hemorroides", "Satisfyer", "Viagra",
	    "Tanga", "Calcetines sucios", "Pa침al", "Papel Higi칠nico",
	    "Cond칩n", "Test de Embarazo", "Coronavirus", "Mascarilla",
	    "Grupo de WhatsApp de Padres", "Reuni칩n de vecinos", "Hipoteca",
	    "Declaraci칩n de la Renta", "Multa de tr치fico", "Tinder", "OnlyFans",
	    "Grindr", "La Isla de las Tentaciones", "S치lvame", "First Dates",
	    
	    // --- ROLES Y ESTEREOTIPOS ---
	    "Cu침ado", "Suegra", "Influencer", "Youtuber", "Vegano",
	    "Crossfitero", "Cayetana", "Perroflauta", "Polic칤a", "Ladr칩n",
	    "Narcotraficante", "Pol칤tico corrupto", "Cura", "Monja",
	    "Stripper", "Sugar Daddy", "Sugar Baby", "Otaku", "Gamer",

	    // --- ANIMALES EXTRA칌OS ---
	    "Ornitorrinco", "Cucaracha", "Rata", "Paloma", "Medusa",
	    "Piojo", "Lombriz", "칌u", "Llama", "Perezoso"
        ];

        // --- ESTADO DEL JUEGO ---
        let selectedPlayerCount = 3; // Valor inicial por defecto

        let gameState = {
            currentStep: 0,
            impostorIndex: -1,
            secretWord: "",
            players: []
        };

        // --- ELEMENTOS DOM ---
        const screens = {
            home: document.getElementById('screen-home'),
            pass: document.getElementById('screen-pass'),
            reveal: document.getElementById('screen-reveal'),
            game: document.getElementById('screen-game')
        };

        const ui = {
            playerCountDisplay: document.getElementById('player-count-display'),
            playerName: document.getElementById('player-name-display'),
            currentPlayerTag: document.getElementById('current-player-tag'),
            secretWord: document.getElementById('secret-word-display'),
            roleIcon: document.getElementById('role-icon-container'),
            roleInstruction: document.getElementById('role-instruction'),
            finalReveal: document.getElementById('final-reveal'),
            finalWord: document.getElementById('final-word'),
            finalImpostor: document.getElementById('final-impostor'),
            statTotalPlayers: document.getElementById('stat-total-players'),
            btnReveal: document.getElementById('btn-reveal')
        };

        // --- INICIALIZACI칍N ---
        lucide.createIcons();

        // --- L칍GICA DE SELECCI칍N DE JUGADORES ---
        function changePlayerCount(delta) {
            selectedPlayerCount += delta;
            
            // L칤mites (M칤nimo 3, M치ximo 20)
            if (selectedPlayerCount < 3) selectedPlayerCount = 3;
            if (selectedPlayerCount > 20) selectedPlayerCount = 20;

            // Actualizar visualizaci칩n con animaci칩n simple
            ui.playerCountDisplay.innerText = selectedPlayerCount;
        }

        // --- NAVEGACI칍N ---
        function switchScreen(screenName) {
            Object.values(screens).forEach(s => {
                s.classList.add('hidden');
                s.classList.remove('flex');
            });
            
            screens[screenName].classList.remove('hidden');
            screens[screenName].classList.add('flex');
            
            lucide.createIcons();
            window.scrollTo(0,0);
        }

        // --- L칍GICA DEL JUEGO ---

        function startGame() {
            // 1. Generar jugadores din치micamente seg칰n la selecci칩n
            gameState.players = [];
            for (let i = 1; i <= selectedPlayerCount; i++) {
                gameState.players.push({ id: i, name: "Jugador " + i });
            }

            // 2. Elegir palabra aleatoria
            gameState.secretWord = WORDS[Math.floor(Math.random() * WORDS.length)];
            
            // 3. Elegir impostor aleatorio (entre 0 y total-1)
            gameState.impostorIndex = Math.floor(Math.random() * selectedPlayerCount);
            
            // 4. Resetear contadores
            gameState.currentStep = 0;
            
            // 5. Preparar UI Final
            ui.finalReveal.classList.add('hidden');
            ui.statTotalPlayers.innerText = selectedPlayerCount;
            ui.btnReveal.disabled = false;
            ui.btnReveal.classList.remove('opacity-50', 'cursor-not-allowed');
            
            // Ir a la primera pantalla de pase
            updatePassScreen();
            switchScreen('pass');
        }

        function updatePassScreen() {
            ui.playerName.innerText = gameState.players[gameState.currentStep].name;
        }

        function revealRole() {
            const isImpostor = gameState.currentStep === gameState.impostorIndex;
            const currentPlayerName = gameState.players[gameState.currentStep].name;
            
            ui.currentPlayerTag.innerText = currentPlayerName;

            if (isImpostor) {
                // Configuraci칩n para el Impostor
                ui.roleIcon.innerHTML = `<i data-lucide="skull" class="w-20 h-20 text-red-500 animate-pulse"></i>`;
                ui.secretWord.innerText = "ERES EL IMPOSTOR";
                ui.secretWord.className = "text-3xl md:text-4xl font-black text-red-500 break-words p-6 bg-red-900/20 rounded-xl border border-red-500/30 shadow-[0_0_30px_rgba(220,38,38,0.2)]";
                ui.roleInstruction.innerText = "춰Shh! No tienes palabra. Escucha a los dem치s, deduce el tema y miente para encajar.";
            } else {
                // Configuraci칩n para el Civil
                ui.roleIcon.innerHTML = `<i data-lucide="shield-check" class="w-20 h-20 text-green-400"></i>`;
                ui.secretWord.innerText = gameState.secretWord;
                ui.secretWord.className = "text-3xl md:text-5xl font-black text-white break-words p-6 bg-slate-900/50 rounded-xl border border-white/10";
                ui.roleInstruction.innerText = "Esta es la palabra secreta. Memor칤zala y di una pista sutil cuando sea tu turno.";
            }
            
            lucide.createIcons();
            switchScreen('reveal');
        }

        function hideRole() {
            gameState.currentStep++;

            // Comparamos con el n칰mero total de jugadores din치mico
            if (gameState.currentStep < gameState.players.length) {
                // Siguiente jugador
                updatePassScreen();
                switchScreen('pass');
            } else {
                // Fin del setup, empezar juego principal
                switchScreen('game');
            }
        }

        function revealImpostor() {
            ui.finalWord.innerText = gameState.secretWord;
            ui.finalImpostor.innerText = gameState.players[gameState.impostorIndex].name;
            
            ui.finalReveal.classList.remove('hidden');
            ui.finalReveal.classList.add('block');
            
            // Deshabilitar bot칩n para evitar pulsaciones dobles confusas
            ui.btnReveal.disabled = true;
            ui.btnReveal.classList.add('opacity-50', 'cursor-not-allowed');
            
            // Scroll hacia el resultado
            setTimeout(() => {
                ui.finalReveal.scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }

        function resetGame() {
            // Volver al inicio pero manteniendo la selecci칩n de jugadores anterior
            switchScreen('home');
        }

    </script>
</body>
</html>
